{"version":3,"sources":["./src/mavo-offline.js"],"names":["$","window","Bliss","Mavo","delay","ms","Promise","resolve","setTimeout","Backend","register","Class","extends","id","constructor","url","o","_this2","this","backendUrl","split","types","filter","test","Remote","backend","permissions","ready","then","online","loading","storing","offlineStatusElem","mavo","element","styleElem","document","createElement","type","rules","createTextNode","appendChild","getElementsByTagName","addOfflineStatusElemStyles","updateStatus","onStatusChange","isOnline","onNewData","backendOnNewData","bind","data","updateStorage","setListenForChanges","upload","load","_this3","loadTry","storageData","storageGet","isNewData","render","setUnsavedChanges","store","_this4","helper","catch","err","status","reject","call","compareDocRevs","storageSet","_this5","unsavedChanges","storeData","storeTry","_this6","login","logout","key","value","localStorage","concat","JSON","stringify","parse","_this","getStatus","setAttribute","textContent","static"],"mappings":"AAAA,cAEA,WACE,IAAIA,EAAIC,OAAOC,MACXC,EAAOF,OAAOE,KA2MlB,SAASC,EAAMC,GACb,OAAO,IAAIC,QAAQ,SAAUC,GAC3BC,WAAWD,EAASF,KA5MxBF,EAAKM,QAAQC,SAASV,EAAEW,MAAM,CAC5BC,QAAST,EAAKM,QACdI,GAAI,UACJC,YAAa,SAAqBC,EAAKC,GACrC,IAAIC,EAASC,KAETC,EAAaJ,EAAIK,MAAM,YAAY,GACnCX,EAAUN,EAAKM,QAAQY,MAAMC,OAAO,SAAUb,GAChD,OAAOA,EAAQc,KAAKJ,KACnB,IAAMhB,EAAKM,QAAQe,OACtBN,KAAKO,QAAU,IAAIhB,EAAQU,EAAYH,GACvCE,KAAKQ,YAAcR,KAAKO,QAAQC,YAChCR,KAAKS,MAAQT,KAAKO,QAAQE,MAAMC,KAAK,WAoBnC,GAnBAX,EAAOY,QAAS,EAChBZ,EAAOa,SAAU,EACjBb,EAAOc,SAAU,EACjBd,EAAOe,kBAAoBhC,EAAE,kBAAmBiB,EAAOgB,KAAKC,SAExDjB,EAAOe,qBAwNjB,WACE,IAAIG,EAAYC,SAASC,cAAc,SACvCF,EAAUG,KAAO,WACjB,IAAIC,EAAQH,SAASI,eAAe,+5BACpCL,EAAUM,YAAYF,GACtBH,SAASM,qBAAqB,QAAQ,GAAGD,YAAYN,GA5N/CQ,GAEA1B,EAAO2B,eAEH3B,EAAOQ,QAAQoB,gBACjB5B,EAAOQ,QAAQoB,eAAe,SAAUC,GACtC7B,EAAOY,OAASiB,EAEhB7B,EAAO2B,kBAKT3B,EAAOQ,QAAQsB,UAAW,CAE5B,IAAIC,EAAmB/B,EAAOQ,QAAQsB,UAAUE,KAAKhC,EAAOQ,SAE5DR,EAAOQ,QAAQsB,UAAY,SAAUG,GACnCjC,EAAOkC,cAAcD,GAErBF,EAAiBE,IAKjBjC,EAAOQ,QAAQ2B,qBACjBnC,EAAOQ,QAAQ2B,qBAAoB,GAGjCnC,EAAOQ,QAAQ4B,SACjBpC,EAAOoC,OAASpC,EAAOQ,QAAQ4B,OAAOJ,KAAKhC,EAAOQ,aAIxD6B,KAAM,WACJ,IAAIC,EAASrC,KAEbA,KAAKS,MAAQT,KAAKS,MAAMC,KAAK,WAC3B,OAAO2B,EAAOC,YAEhB,IAAIC,EAAcvC,KAAKwC,WAAW,QAElC,OAAID,GACFvC,KAAKS,MAAMC,KAAK,SAAUsB,GACxB,OAAIK,EAAOI,UAAUT,IACnBK,EAAOtB,KAAK2B,OAAOV,GAEnBK,EAAOtB,KAAK4B,mBAAkB,QAE9BN,EAAOJ,cAAcD,IAKnBK,EAAOG,WAAW,YACbH,EAAOO,MAAMP,EAAOG,WAAW,cADxC,IAIKpD,QAAQC,QAAQkD,IAGlBvC,KAAKS,MAAMC,KAAK,SAAUsB,GAG/B,OAFAK,EAAOJ,cAAcD,GAEdA,KAGXM,QAAS,WACP,IAAIO,EAAS7C,KAIb,OAFAA,KAAKY,SAAU,EACfZ,KAAK0B,eASL,SAASoB,IACP,OAAO9C,KAAKO,QAAQ6B,OAAOW,MAAM,SAAUC,GACzC,OAAmB,IAAfA,EAAIC,OACC/D,EAAM,KAAMwB,KAAK,WACtB,OAAOoC,MAIJ1D,QAAQ8D,OAAOF,MAhBZG,KAAKnD,MAAMU,KAAK,SAAUsB,GAKtC,OAJAa,EAAOjC,SAAU,EAEjBiC,EAAOnB,eAEAM,GAAQ,MAenBS,UAAW,SAAmBT,GAC5B,OAAKhC,KAAKO,QAAQ6C,gBAIoD,IAA/DpD,KAAKO,QAAQ6C,eAAepD,KAAKwC,WAAW,QAASR,IAE9DC,cAAe,SAAuBD,GACpChC,KAAKqD,WAAW,OAAQrB,GACxBhC,KAAKqD,WAAW,YAAY,IAE9BT,MAAO,SAAeZ,GACpB,IAAIsB,EAAStD,KAEb,OAAKA,KAAKe,KAAKwC,iBAIfvD,KAAKqD,WAAW,OAAQrB,GACxBhC,KAAKqD,WAAW,YAAY,GAC5BrD,KAAKwD,UAAYxB,EAEZhC,KAAKa,UACRb,KAAKa,SAAU,EACfb,KAAK0B,eACL1B,KAAKS,MAAQT,KAAKS,MAAMC,KAAK,WAC3B,OAAO4C,EAAOG,aACb/C,KAAK,WACN4C,EAAOzC,SAAU,EAEjByC,EAAO5B,mBAIJtC,QAAQC,WAEjBoE,SAAU,SAAkBzB,GAC1B,IAAI0B,EAAS1D,KAIb,OAFAgC,EAAOhC,KAAKwD,WAAaxB,SAClBhC,KAAKwD,UACLxD,KAAKO,QAAQqC,MAAMZ,GAAMe,MAAM,SAAUC,GAC9C,OAAQA,EAAIC,QACV,KAAK,EACH,OAAO/D,EAAM,KAAMwB,KAAK,WACtB,OAAOgD,EAAOD,SAASzB,KAO7B,OAAO5C,QAAQ8D,OAAOF,KACrBtC,KAAK,WACN,GAAIgD,EAAOF,UACT,OAAOE,EAAOD,cAIpBE,MAAO,WACL,OAAO3D,KAAKO,QAAQoD,SAEtBC,OAAQ,WACN,OAAO5D,KAAKO,QAAQqD,UAEtBP,WAAY,SAAoBQ,EAAKC,GACnC,IACE/E,OAAOgF,aAAa,WAAWC,OAAOhE,KAAKe,KAAKpB,IAAM,UAAW,KAAKqE,OAAOH,IAAQI,KAAKC,UAAUJ,GACpG,MAAOd,MAEXR,WAAY,SAAoBqB,GAC9B,IACE,OAAOI,KAAKE,MAAMpF,OAAOgF,aAAa,WAAWC,OAAOhE,KAAKe,KAAKpB,IAAM,UAAW,KAAKqE,OAAOH,KAC/F,MAAOb,MAEXtB,aAAc,WACZ,GAAK1B,KAAKc,kBAAV,CAIA,IAAImC,EAiBR,SAAmBmB,GAKjB,GAAIA,EAAM7D,QAAQoB,eAAgB,CAChC,IAAKyC,EAAMzD,OACT,MAAO,UAGT,IAAKyD,EAAMvD,UAAYuD,EAAMxD,QAC3B,MAAO,aAIX,GAAIwD,EAAMxD,QACR,MAAO,UAGT,GAAIwD,EAAMvD,QACR,MAAO,UAGT,MAAO,OAxCQwD,CAAUrE,MACvBA,KAAKc,kBAAkBwD,aAAa,SAAUrB,GAC9CjD,KAAKc,kBAAkByD,YAActB,IAEvCuB,OAAQ,CACNnE,KAAM,SAAcyD,GAClB,MAAO,UAAUzD,KAAKyD,QAxM9B"}